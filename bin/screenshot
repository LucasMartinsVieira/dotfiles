#!/usr/bin/env bash

LOCATION=$HOME/Imagens/Screenshot/
TIME=$(date +"%y%m%d-%H%M-%S")

notify_user() {
  notify-send -t 1000 -u normal "Screenshot Tool" "Smile ðŸ“¸"
}

full() {
  grim - | satty \
    --filename - \
    --output-filename "$LOCATION$TIME.png" \
    --early-exit \
    --actions-on-enter save-to-clipboard \
    --save-after-copy \
    --copy-command 'wl-copy'
}

area() {
  grim -g "$(slurp)" - | satty \
    --filename - \
    --output-filename "$LOCATION$TIME.png" \
    --early-exit \
    --actions-on-enter save-to-clipboard \
    --save-after-copy \
    --copy-command 'wl-copy'
}

window() {
  notify-send -t 1000 -u normal "Screenshot Tool" "TODO"
}

OPTIONS="Full
Area"

select_option() {
  CHOICE=$(printf "%s\n" "$OPTIONS" | fuzzel --lines 4 --dmenu --prompt="Screenshot:")

  case "$CHOICE" in
  *Full)
    sleep 1 && full
    ;;
  *Area)
    sleep 1 && area
    ;;
  *)
    exit 0
    ;;
  esac
}

if [[ "$1" == "--full" ]]; then
  full
elif [[ "$1" == "--area" ]]; then
  area
elif [[ "$1" == "--window" ]]; then
  window
else
  select_option
fi
